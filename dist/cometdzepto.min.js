var Zepto=function(){function t(t){return null==t?String(t):W[z.call(t)]||"object"}function e(e){return"function"==t(e)}function n(t){return null!=t&&t==t.window}function r(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function i(e){return"object"==t(e)}function o(t){return i(t)&&!n(t)&&Object.getPrototypeOf(t)==Object.prototype}function s(t){return"number"==typeof t.length}function a(t){return N.call(t,function(t){return null!=t})}function c(t){return t.length>0?_.fn.concat.apply([],t):t}function u(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function l(t){return t in L?L[t]:L[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function f(t,e){return"number"!=typeof e||A[u(t)]?e:e+"px"}function h(t){var e,n;return R[t]||(e=O.createElement(t),O.body.appendChild(e),n=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==n&&(n="block"),R[t]=n),R[t]}function d(t){return"children"in t?j.call(t.children):_.map(t.childNodes,function(t){return 1==t.nodeType?t:void 0})}function p(t,e,n){for(w in e)n&&(o(e[w])||Y(e[w]))?(o(e[w])&&!o(t[w])&&(t[w]={}),Y(e[w])&&!Y(t[w])&&(t[w]=[]),p(t[w],e[w],n)):e[w]!==x&&(t[w]=e[w])}function g(t,e){return null==e?_(t):_(t).filter(e)}function m(t,n,r,i){return e(n)?n.call(t,r,i):n}function v(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function b(t,e){var n=t.className,r=n&&n.baseVal!==x;return e===x?r?n.baseVal:n:void(r?n.baseVal=e:t.className=e)}function y(t){var e;try{return t?"true"==t||("false"==t?!1:"null"==t?null:/^0/.test(t)||isNaN(e=Number(t))?/^[\[\{]/.test(t)?_.parseJSON(t):t:e):t}catch(n){return t}}function T(t,e){e(t);for(var n=0,r=t.childNodes.length;r>n;n++)T(t.childNodes[n],e)}var x,w,_,S,k,C,E=[],j=E.slice,N=E.filter,O=window.document,R={},L={},A={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},U=/^\s*<(\w+|!)[^>]*>/,I=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,q=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,F=/^(?:body|html)$/i,P=/([A-Z])/g,D=["val","css","html","text","data","width","height","offset"],M=["after","prepend","before","append"],J=O.createElement("table"),B=O.createElement("tr"),$={tr:O.createElement("tbody"),tbody:J,thead:J,tfoot:J,td:B,th:B,"*":O.createElement("div")},Z=/complete|loaded|interactive/,H=/^[\w-]*$/,W={},z=W.toString,V={},X=O.createElement("div"),G={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},Y=Array.isArray||function(t){return t instanceof Array};return V.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var n=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(n)return n.call(t,e);var r,i=t.parentNode,o=!i;return o&&(i=X).appendChild(t),r=~V.qsa(i,e).indexOf(t),o&&X.removeChild(t),r},k=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},C=function(t){return N.call(t,function(e,n){return t.indexOf(e)==n})},V.fragment=function(t,e,n){var r,i,s;return I.test(t)&&(r=_(O.createElement(RegExp.$1))),r||(t.replace&&(t=t.replace(q,"<$1></$2>")),e===x&&(e=U.test(t)&&RegExp.$1),e in $||(e="*"),s=$[e],s.innerHTML=""+t,r=_.each(j.call(s.childNodes),function(){s.removeChild(this)})),o(n)&&(i=_(r),_.each(n,function(t,e){D.indexOf(t)>-1?i[t](e):i.attr(t,e)})),r},V.Z=function(t,e){return t=t||[],t.__proto__=_.fn,t.selector=e||"",t},V.isZ=function(t){return t instanceof V.Z},V.init=function(t,n){var r;if(!t)return V.Z();if("string"==typeof t)if(t=t.trim(),"<"==t[0]&&U.test(t))r=V.fragment(t,RegExp.$1,n),t=null;else{if(n!==x)return _(n).find(t);r=V.qsa(O,t)}else{if(e(t))return _(O).ready(t);if(V.isZ(t))return t;if(Y(t))r=a(t);else if(i(t))r=[t],t=null;else if(U.test(t))r=V.fragment(t.trim(),RegExp.$1,n),t=null;else{if(n!==x)return _(n).find(t);r=V.qsa(O,t)}}return V.Z(r,t)},_=function(t,e){return V.init(t,e)},_.extend=function(t){var e,n=j.call(arguments,1);return"boolean"==typeof t&&(e=t,t=n.shift()),n.forEach(function(n){p(t,n,e)}),t},V.qsa=function(t,e){var n,i="#"==e[0],o=!i&&"."==e[0],s=i||o?e.slice(1):e,a=H.test(s);return r(t)&&a&&i?(n=t.getElementById(s))?[n]:[]:1!==t.nodeType&&9!==t.nodeType?[]:j.call(a&&!i?o?t.getElementsByClassName(s):t.getElementsByTagName(e):t.querySelectorAll(e))},_.contains=O.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e&&(e=e.parentNode);)if(e===t)return!0;return!1},_.type=t,_.isFunction=e,_.isWindow=n,_.isArray=Y,_.isPlainObject=o,_.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},_.inArray=function(t,e,n){return E.indexOf.call(e,t,n)},_.camelCase=k,_.trim=function(t){return null==t?"":String.prototype.trim.call(t)},_.uuid=0,_.support={},_.expr={},_.map=function(t,e){var n,r,i,o=[];if(s(t))for(r=0;r<t.length;r++)n=e(t[r],r),null!=n&&o.push(n);else for(i in t)n=e(t[i],i),null!=n&&o.push(n);return c(o)},_.each=function(t,e){var n,r;if(s(t)){for(n=0;n<t.length;n++)if(e.call(t[n],n,t[n])===!1)return t}else for(r in t)if(e.call(t[r],r,t[r])===!1)return t;return t},_.grep=function(t,e){return N.call(t,e)},window.JSON&&(_.parseJSON=JSON.parse),_.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){W["[object "+e+"]"]=e.toLowerCase()}),_.fn={forEach:E.forEach,reduce:E.reduce,push:E.push,sort:E.sort,indexOf:E.indexOf,concat:E.concat,map:function(t){return _(_.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return _(j.apply(this,arguments))},ready:function(t){return Z.test(O.readyState)&&O.body?t(_):O.addEventListener("DOMContentLoaded",function(){t(_)},!1),this},get:function(t){return t===x?j.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return E.every.call(this,function(e,n){return t.call(e,n,e)!==!1}),this},filter:function(t){return e(t)?this.not(this.not(t)):_(N.call(this,function(e){return V.matches(e,t)}))},add:function(t,e){return _(C(this.concat(_(t,e))))},is:function(t){return this.length>0&&V.matches(this[0],t)},not:function(t){var n=[];if(e(t)&&t.call!==x)this.each(function(e){t.call(this,e)||n.push(this)});else{var r="string"==typeof t?this.filter(t):s(t)&&e(t.item)?j.call(t):_(t);this.forEach(function(t){r.indexOf(t)<0&&n.push(t)})}return _(n)},has:function(t){return this.filter(function(){return i(t)?_.contains(this,t):_(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!i(t)?t:_(t)},last:function(){var t=this[this.length-1];return t&&!i(t)?t:_(t)},find:function(t){var e,n=this;return e=t?"object"==typeof t?_(t).filter(function(){var t=this;return E.some.call(n,function(e){return _.contains(e,t)})}):1==this.length?_(V.qsa(this[0],t)):this.map(function(){return V.qsa(this,t)}):[]},closest:function(t,e){var n=this[0],i=!1;for("object"==typeof t&&(i=_(t));n&&!(i?i.indexOf(n)>=0:V.matches(n,t));)n=n!==e&&!r(n)&&n.parentNode;return _(n)},parents:function(t){for(var e=[],n=this;n.length>0;)n=_.map(n,function(t){return(t=t.parentNode)&&!r(t)&&e.indexOf(t)<0?(e.push(t),t):void 0});return g(e,t)},parent:function(t){return g(C(this.pluck("parentNode")),t)},children:function(t){return g(this.map(function(){return d(this)}),t)},contents:function(){return this.map(function(){return j.call(this.childNodes)})},siblings:function(t){return g(this.map(function(t,e){return N.call(d(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return _.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=h(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var n=e(t);if(this[0]&&!n)var r=_(t).get(0),i=r.parentNode||this.length>1;return this.each(function(e){_(this).wrapAll(n?t.call(this,e):i?r.cloneNode(!0):r)})},wrapAll:function(t){if(this[0]){_(this[0]).before(t=_(t));for(var e;(e=t.children()).length;)t=e.first();_(t).append(this)}return this},wrapInner:function(t){var n=e(t);return this.each(function(e){var r=_(this),i=r.contents(),o=n?t.call(this,e):t;i.length?i.wrapAll(o):r.append(o)})},unwrap:function(){return this.parent().each(function(){_(this).replaceWith(_(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=_(this);(t===x?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(t){return _(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return _(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return 0 in arguments?this.each(function(e){var n=this.innerHTML;_(this).empty().append(m(this,t,e,n))}):0 in this?this[0].innerHTML:null},text:function(t){return 0 in arguments?this.each(function(e){var n=m(this,t,e,this.textContent);this.textContent=null==n?"":""+n}):0 in this?this[0].textContent:null},attr:function(t,e){var n;return"string"!=typeof t||1 in arguments?this.each(function(n){if(1===this.nodeType)if(i(t))for(w in t)v(this,w,t[w]);else v(this,t,m(this,e,n,this.getAttribute(t)))}):this.length&&1===this[0].nodeType?!(n=this[0].getAttribute(t))&&t in this[0]?this[0][t]:n:x},removeAttr:function(t){return this.each(function(){1===this.nodeType&&v(this,t)})},prop:function(t,e){return t=G[t]||t,1 in arguments?this.each(function(n){this[t]=m(this,e,n,this[t])}):this[0]&&this[0][t]},data:function(t,e){var n="data-"+t.replace(P,"-$1").toLowerCase(),r=1 in arguments?this.attr(n,e):this.attr(n);return null!==r?y(r):x},val:function(t){return 0 in arguments?this.each(function(e){this.value=m(this,t,e,this.value)}):this[0]&&(this[0].multiple?_(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(t){if(t)return this.each(function(e){var n=_(this),r=m(this,t,e,n.offset()),i=n.offsetParent().offset(),o={top:r.top-i.top,left:r.left-i.left};"static"==n.css("position")&&(o.position="relative"),n.css(o)});if(!this.length)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,n){if(arguments.length<2){var r=this[0],i=getComputedStyle(r,"");if(!r)return;if("string"==typeof e)return r.style[k(e)]||i.getPropertyValue(e);if(Y(e)){var o={};return _.each(Y(e)?e:[e],function(t,e){o[e]=r.style[k(e)]||i.getPropertyValue(e)}),o}}var s="";if("string"==t(e))n||0===n?s=u(e)+":"+f(e,n):this.each(function(){this.style.removeProperty(u(e))});else for(w in e)e[w]||0===e[w]?s+=u(w)+":"+f(w,e[w])+";":this.each(function(){this.style.removeProperty(u(w))});return this.each(function(){this.style.cssText+=";"+s})},index:function(t){return t?this.indexOf(_(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return t?E.some.call(this,function(t){return this.test(b(t))},l(t)):!1},addClass:function(t){return t?this.each(function(e){S=[];var n=b(this),r=m(this,t,e,n);r.split(/\s+/g).forEach(function(t){_(this).hasClass(t)||S.push(t)},this),S.length&&b(this,n+(n?" ":"")+S.join(" "))}):this},removeClass:function(t){return this.each(function(e){return t===x?b(this,""):(S=b(this),m(this,t,e,S).split(/\s+/g).forEach(function(t){S=S.replace(l(t)," ")}),void b(this,S.trim()))})},toggleClass:function(t,e){return t?this.each(function(n){var r=_(this),i=m(this,t,n,b(this));i.split(/\s+/g).forEach(function(t){(e===x?!r.hasClass(t):e)?r.addClass(t):r.removeClass(t)})}):this},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return t===x?e?this[0].scrollTop:this[0].pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return t===x?e?this[0].scrollLeft:this[0].pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),n=this.offset(),r=F.test(e[0].nodeName)?{top:0,left:0}:e.offset();return n.top-=parseFloat(_(t).css("margin-top"))||0,n.left-=parseFloat(_(t).css("margin-left"))||0,r.top+=parseFloat(_(e[0]).css("border-top-width"))||0,r.left+=parseFloat(_(e[0]).css("border-left-width"))||0,{top:n.top-r.top,left:n.left-r.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||O.body;t&&!F.test(t.nodeName)&&"static"==_(t).css("position");)t=t.offsetParent;return t})}},_.fn.detach=_.fn.remove,["width","height"].forEach(function(t){var e=t.replace(/./,function(t){return t[0].toUpperCase()});_.fn[t]=function(i){var o,s=this[0];return i===x?n(s)?s["inner"+e]:r(s)?s.documentElement["scroll"+e]:(o=this.offset())&&o[t]:this.each(function(e){s=_(this),s.css(t,m(this,i,e,s[t]()))})}}),M.forEach(function(e,n){var r=n%2;_.fn[e]=function(){var e,i,o=_.map(arguments,function(n){return e=t(n),"object"==e||"array"==e||null==n?n:V.fragment(n)}),s=this.length>1;return o.length<1?this:this.each(function(t,e){i=r?e:e.parentNode,e=0==n?e.nextSibling:1==n?e.firstChild:2==n?e:null;var a=_.contains(O.documentElement,i);o.forEach(function(t){if(s)t=t.cloneNode(!0);else if(!i)return _(t).remove();i.insertBefore(t,e),a&&T(t,function(t){null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||window.eval.call(window,t.innerHTML)})})})},_.fn[r?e+"To":"insert"+(n?"Before":"After")]=function(t){return _(t)[e](this),this}}),V.Z.prototype=_.fn,V.uniq=C,V.deserializeValue=y,_.zepto=V,_}();window.Zepto=Zepto,void 0===window.$&&(window.$=Zepto),function(t){function e(t){return t._zid||(t._zid=h++)}function n(t,n,o,s){if(n=r(n),n.ns)var a=i(n.ns);return(m[e(t)]||[]).filter(function(t){return!(!t||n.e&&t.e!=n.e||n.ns&&!a.test(t.ns)||o&&e(t.fn)!==e(o)||s&&t.sel!=s)})}function r(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function i(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function o(t,e){return t.del&&!b&&t.e in y||!!e}function s(t){return T[t]||b&&y[t]||t}function a(n,i,a,c,l,h,d){var p=e(n),g=m[p]||(m[p]=[]);i.split(/\s/).forEach(function(e){if("ready"==e)return t(document).ready(a);var i=r(e);i.fn=a,i.sel=l,i.e in T&&(a=function(e){var n=e.relatedTarget;return!n||n!==this&&!t.contains(this,n)?i.fn.apply(this,arguments):void 0}),i.del=h;var p=h||a;i.proxy=function(t){if(t=u(t),!t.isImmediatePropagationStopped()){t.data=c;var e=p.apply(n,t._args==f?[t]:[t].concat(t._args));return e===!1&&(t.preventDefault(),t.stopPropagation()),e}},i.i=g.length,g.push(i),"addEventListener"in n&&n.addEventListener(s(i.e),i.proxy,o(i,d))})}function c(t,r,i,a,c){var u=e(t);(r||"").split(/\s/).forEach(function(e){n(t,e,i,a).forEach(function(e){delete m[u][e.i],"removeEventListener"in t&&t.removeEventListener(s(e.e),e.proxy,o(e,c))})})}function u(e,n){return(n||!e.isDefaultPrevented)&&(n||(n=e),t.each(S,function(t,r){var i=n[t];e[t]=function(){return this[r]=x,i&&i.apply(n,arguments)},e[r]=w}),(n.defaultPrevented!==f?n.defaultPrevented:"returnValue"in n?n.returnValue===!1:n.getPreventDefault&&n.getPreventDefault())&&(e.isDefaultPrevented=x)),e}function l(t){var e,n={originalEvent:t};for(e in t)_.test(e)||t[e]===f||(n[e]=t[e]);return u(n,t)}var f,h=1,d=Array.prototype.slice,p=t.isFunction,g=function(t){return"string"==typeof t},m={},v={},b="onfocusin"in window,y={focus:"focusin",blur:"focusout"},T={mouseenter:"mouseover",mouseleave:"mouseout"};v.click=v.mousedown=v.mouseup=v.mousemove="MouseEvents",t.event={add:a,remove:c},t.proxy=function(n,r){var i=2 in arguments&&d.call(arguments,2);if(p(n)){var o=function(){return n.apply(r,i?i.concat(d.call(arguments)):arguments)};return o._zid=e(n),o}if(g(r))return i?(i.unshift(n[r],n),t.proxy.apply(null,i)):t.proxy(n[r],n);throw new TypeError("expected function")},t.fn.bind=function(t,e,n){return this.on(t,e,n)},t.fn.unbind=function(t,e){return this.off(t,e)},t.fn.one=function(t,e,n,r){return this.on(t,e,n,r,1)};var x=function(){return!0},w=function(){return!1},_=/^([A-Z]|returnValue$|layer[XY]$)/,S={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(t,e,n){return this.on(e,t,n)},t.fn.undelegate=function(t,e,n){return this.off(e,t,n)},t.fn.live=function(e,n){return t(document.body).delegate(this.selector,e,n),this},t.fn.die=function(e,n){return t(document.body).undelegate(this.selector,e,n),this},t.fn.on=function(e,n,r,i,o){var s,u,h=this;return e&&!g(e)?(t.each(e,function(t,e){h.on(t,n,r,e,o)}),h):(g(n)||p(i)||i===!1||(i=r,r=n,n=f),(p(r)||r===!1)&&(i=r,r=f),i===!1&&(i=w),h.each(function(f,h){o&&(s=function(t){return c(h,t.type,i),i.apply(this,arguments)}),n&&(u=function(e){var r,o=t(e.target).closest(n,h).get(0);return o&&o!==h?(r=t.extend(l(e),{currentTarget:o,liveFired:h}),(s||i).apply(o,[r].concat(d.call(arguments,1)))):void 0}),a(h,e,i,r,n,u||s)}))},t.fn.off=function(e,n,r){var i=this;return e&&!g(e)?(t.each(e,function(t,e){i.off(t,n,e)}),i):(g(n)||p(r)||r===!1||(r=n,n=f),r===!1&&(r=w),i.each(function(){c(this,e,r,n)}))},t.fn.trigger=function(e,n){return e=g(e)||t.isPlainObject(e)?t.Event(e):u(e),e._args=n,this.each(function(){"dispatchEvent"in this?this.dispatchEvent(e):t(this).triggerHandler(e,n)})},t.fn.triggerHandler=function(e,r){var i,o;return this.each(function(s,a){i=l(g(e)?t.Event(e):e),i._args=r,i.target=a,t.each(n(a,e.type||e),function(t,e){return o=e.proxy(i),i.isImmediatePropagationStopped()?!1:void 0})}),o},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.trigger(e)}}),["focus","blur"].forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.each(function(){try{this[e]()}catch(t){}}),this}}),t.Event=function(t,e){g(t)||(e=t,t=e.type);var n=document.createEvent(v[t]||"Events"),r=!0;if(e)for(var i in e)"bubbles"==i?r=!!e[i]:n[i]=e[i];return n.initEvent(t,r,!0),u(n)}}(Zepto),function(t){function e(e,n,r){var i=t.Event(n);return t(e).trigger(i,r),!i.isDefaultPrevented()}function n(t,n,r,i){return t.global?e(n||b,r,i):void 0}function r(e){e.global&&0===t.active++&&n(e,null,"ajaxStart")}function i(e){e.global&&!--t.active&&n(e,null,"ajaxStop")}function o(t,e){var r=e.context;return e.beforeSend.call(r,t,e)===!1||n(e,r,"ajaxBeforeSend",[t,e])===!1?!1:void n(e,r,"ajaxSend",[t,e])}function s(t,e,r,i){var o=r.context,s="success";r.success.call(o,t,s,e),i&&i.resolveWith(o,[t,s,e]),n(r,o,"ajaxSuccess",[e,r,t]),c(s,e,r)}function a(t,e,r,i,o){var s=i.context;i.error.call(s,r,e,t),o&&o.rejectWith(s,[r,e,t]),n(i,s,"ajaxError",[r,i,t||e]),c(e,r,i)}function c(t,e,r){var o=r.context;r.complete.call(o,e,t),n(r,o,"ajaxComplete",[e,r]),i(r)}function u(){}function l(t){return t&&(t=t.split(";",2)[0]),t&&(t==_?"html":t==w?"json":T.test(t)?"script":x.test(t)&&"xml")||"text"}function f(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function h(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=f(e.url,e.data),e.data=void 0)}function d(e,n,r,i){return t.isFunction(n)&&(i=r,r=n,n=void 0),t.isFunction(r)||(i=r,r=void 0),{url:e,data:n,success:r,dataType:i}}function p(e,n,r,i){var o,s=t.isArray(n),a=t.isPlainObject(n);t.each(n,function(n,c){o=t.type(c),i&&(n=r?i:i+"["+(a||"object"==o||"array"==o?n:"")+"]"),!i&&s?e.add(c.name,c.value):"array"==o||!r&&"object"==o?p(e,c,r,n):e.add(n,c)})}var g,m,v=0,b=window.document,y=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,T=/^(?:text|application)\/javascript/i,x=/^(?:text|application)\/xml/i,w="application/json",_="text/html",S=/^\s*$/;t.active=0,t.ajaxJSONP=function(e,n){if(!("type"in e))return t.ajax(e);var r,i,c=e.jsonpCallback,u=(t.isFunction(c)?c():c)||"jsonp"+ ++v,l=b.createElement("script"),f=window[u],h=function(e){t(l).triggerHandler("error",e||"abort")},d={abort:h};return n&&n.promise(d),t(l).on("load error",function(o,c){clearTimeout(i),t(l).off().remove(),"error"!=o.type&&r?s(r[0],d,e,n):a(null,c||"error",d,e,n),window[u]=f,r&&t.isFunction(f)&&f(r[0]),f=r=void 0}),o(d,e)===!1?(h("abort"),d):(window[u]=function(){r=arguments},l.src=e.url.replace(/\?(.+)=\?/,"?$1="+u),b.head.appendChild(l),e.timeout>0&&(i=setTimeout(function(){h("timeout")},e.timeout)),d)},t.ajaxSettings={type:"GET",beforeSend:u,success:u,error:u,complete:u,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:w,xml:"application/xml, text/xml",html:_,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},t.ajax=function(e){var n=t.extend({},e||{}),i=t.Deferred&&t.Deferred();for(g in t.ajaxSettings)void 0===n[g]&&(n[g]=t.ajaxSettings[g]);r(n),n.crossDomain||(n.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(n.url)&&RegExp.$2!=window.location.host),n.url||(n.url=window.location.toString()),h(n);var c=n.dataType,d=/\?.+=\?/.test(n.url);if(d&&(c="jsonp"),n.cache!==!1&&(e&&e.cache===!0||"script"!=c&&"jsonp"!=c)||(n.url=f(n.url,"_="+Date.now())),"jsonp"==c)return d||(n.url=f(n.url,n.jsonp?n.jsonp+"=?":n.jsonp===!1?"":"callback=?")),t.ajaxJSONP(n,i);var p,v=n.accepts[c],b={},y=function(t,e){b[t.toLowerCase()]=[t,e]},T=/^([\w-]+:)\/\//.test(n.url)?RegExp.$1:window.location.protocol,x=n.xhr(),w=x.setRequestHeader;if(i&&i.promise(x),n.crossDomain||y("X-Requested-With","XMLHttpRequest"),y("Accept",v||"*/*"),(v=n.mimeType||v)&&(v.indexOf(",")>-1&&(v=v.split(",",2)[0]),x.overrideMimeType&&x.overrideMimeType(v)),(n.contentType||n.contentType!==!1&&n.data&&"GET"!=n.type.toUpperCase())&&y("Content-Type",n.contentType||"application/x-www-form-urlencoded"),n.headers)for(m in n.headers)y(m,n.headers[m]);if(x.setRequestHeader=y,x.onreadystatechange=function(){if(4==x.readyState){x.onreadystatechange=u,clearTimeout(p);var e,r=!1;if(x.status>=200&&x.status<300||304==x.status||0==x.status&&"file:"==T){c=c||l(n.mimeType||x.getResponseHeader("content-type")),e=x.responseText;try{"script"==c?(1,eval)(e):"xml"==c?e=x.responseXML:"json"==c&&(e=S.test(e)?null:t.parseJSON(e))}catch(o){r=o}r?a(r,"parsererror",x,n,i):s(e,x,n,i)}else a(x.statusText||null,x.status?"error":"abort",x,n,i)}},o(x,n)===!1)return x.abort(),a(null,"abort",x,n,i),x;if(n.xhrFields)for(m in n.xhrFields)x[m]=n.xhrFields[m];var _="async"in n?n.async:!0;x.open(n.type,n.url,_,n.username,n.password);for(m in b)w.apply(x,b[m]);return n.timeout>0&&(p=setTimeout(function(){x.onreadystatechange=u,x.abort(),a(null,"timeout",x,n,i)},n.timeout)),x.send(n.data?n.data:null),x},t.get=function(){return t.ajax(d.apply(null,arguments))},t.post=function(){var e=d.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=d.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,n,r){if(!this.length)return this;var i,o=this,s=e.split(/\s/),a=d(e,n,r),c=a.success;return s.length>1&&(a.url=s[0],i=s[1]),a.success=function(e){o.html(i?t("<div>").html(e.replace(y,"")).find(i):e),c&&c.apply(o,arguments)},t.ajax(a),this};var k=encodeURIComponent;t.param=function(t,e){var n=[];return n.add=function(t,e){this.push(k(t)+"="+k(e))},p(n,t,e),n.join("&").replace(/%20/g,"+")}}(Zepto),function(t){t.fn.serializeArray=function(){var e,n=[];return t([].slice.call(this.get(0).elements)).each(function(){e=t(this);var r=e.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=r&&"reset"!=r&&"button"!=r&&("radio"!=r&&"checkbox"!=r||this.checked)&&n.push({name:e.attr("name"),value:e.val()})}),n},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(e)this.bind("submit",e);else if(this.length){var n=t.Event("submit");this.eq(0).trigger(n),n.isDefaultPrevented()||this.get(0).submit()}return this}}(Zepto),function(t){"__proto__"in{}||t.extend(t.zepto,{Z:function(e,n){return e=e||[],t.extend(e,t.fn),e.selector=n||"",e.__Z=!0,e},isZ:function(e){return"array"===t.type(e)&&"__Z"in e}});try{getComputedStyle(void 0)}catch(e){var n=getComputedStyle;window.getComputedStyle=function(t){try{return n(t)}catch(e){return null}}}}(Zepto);var jQuery=Zepto;this.org=this.org||{},org.cometd={},org.cometd.CometD=function(t){function e(t,e){try{return t[e]}catch(n){return void 0}}function n(t){return org.cometd.Utils.isString(t)}function r(t){return void 0===t||null===t?!1:"function"==typeof t}function i(t,e){if(window.console){var n=window.console[t];r(n)&&n.apply(window.console,e)}}function o(t){oe._debug("Configuring cometd object with",t),n(t)&&(t={url:t}),t||(t={}),_e=oe._mixin(!1,_e,t);var e=oe.getURL();if(!e)throw"Missing required configuration parameter 'url' specifying the Bayeux server URL";var r=/(^https?:\/\/)?(((\[[^\]]+\])|([^:\/\?#]+))(:(\d+))?)?([^\?#]*)(.*)?/.exec(e),i=r[2],o=r[8],s=r[9];if(ae=oe._isCrossDomain(i),_e.appendMessageTypeToURL)if(void 0!==s&&s.length>0)oe._info("Appending message type to URI "+o+s+" is not supported, disabling 'appendMessageTypeToURL' configuration"),_e.appendMessageTypeToURL=!1;else{var a=o.split("/"),c=a.length-1;o.match(/\/$/)&&(c-=1),a[c].indexOf(".")>=0&&(oe._info("Appending message type to URI "+o+" is not supported, disabling 'appendMessageTypeToURL' configuration"),_e.appendMessageTypeToURL=!1)}}function s(t){if(t){var e=ge[t.channel];e&&e[t.id]&&(delete e[t.id],oe._debug("Removed",t.listener?"listener":"subscription",t))}}function a(t){t&&!t.listener&&s(t)}function c(){for(var t in ge){var e=ge[t];if(e)for(var n=0;n<e.length;++n)a(e[n])}}function u(t){ue!==t&&(oe._debug("Status",ue,"->",t),ue=t)}function l(){return"disconnecting"===ue||"disconnected"===ue}function f(){return++le}function h(t,e,n,i,o){try{return e.call(t,i)}catch(s){oe._debug("Exception during execution of extension",n,s);var a=oe.onExtensionException;if(r(a)){oe._debug("Invoking extension exception callback",n,s);try{a.call(oe,s,n,o,i)}catch(c){oe._info("Exception during execution of exception callback in extension",n,c)}}return i}}function d(t){for(var e=0;e<be.length&&(void 0!==t&&null!==t);++e){var n=_e.reverseIncomingExtensions?be.length-1-e:e,i=be[n],o=i.extension.incoming;if(r(o)){var s=h(i.extension,o,i.name,t,!1);t=void 0===s?t:s}}return t}function p(t){for(var e=0;e<be.length&&(void 0!==t&&null!==t);++e){var n=be[e],i=n.extension.outgoing;if(r(i)){var o=h(n.extension,i,n.name,t,!0);t=void 0===o?t:o}}return t}function g(t,e){var n=ge[t];if(n&&n.length>0)for(var i=0;i<n.length;++i){var o=n[i];if(o)try{o.callback.call(o.scope,e)}catch(s){oe._debug("Exception during notification",o,e,s);var a=oe.onListenerException;if(r(a)){oe._debug("Invoking listener exception callback",o,s);try{a.call(oe,s,o,o.listener,e)}catch(c){oe._info("Exception during execution of listener callback",o,c)}}}}}function m(t,e){g(t,e);for(var n=t.split("/"),r=n.length-1,i=r;i>0;--i){var o=n.slice(0,i).join("/")+"/*";i===r&&g(o,e),o+="*",g(o,e)}}function v(){null!==ve&&org.cometd.Utils.clearTimeout(ve),ve=null}function b(t){v();var e=ye.interval+me;oe._debug("Function scheduled in",e,"ms, interval =",ye.interval,"backoff =",me,t),ve=org.cometd.Utils.setTimeout(oe,t,e)}function y(t,e,n,i){for(var o=0;o<e.length;++o){var s=e[o],a=""+f();s.id=a,fe&&(s.clientId=fe);var c=void 0;r(s._callback)&&(c=s._callback,delete s._callback),s=p(s),void 0!==s&&null!==s?(s.id=a,e[o]=s,c&&(Te[a]=c)):e.splice(o--,1)}if(0!==e.length){var u=oe.getURL();_e.appendMessageTypeToURL&&(u.match(/\/$/)||(u+="/"),i&&(u+=i));var l={url:u,sync:t,messages:e,onSuccess:function(t){try{Se.call(oe,t)}catch(e){oe._debug("Exception during handling of messages",e)}},onFailure:function(t,e,n){try{var r=oe.getTransport();n.connectionType=r?r.getType():"unknown",ke.call(oe,t,e,n)}catch(i){oe._debug("Exception during handling of failure",i)}}};oe._debug("Send",l),ne.send(l,n)}}function T(t){he>0||pe===!0?de.push(t):y(!1,[t],!1)}function x(){me=0}function w(){me<_e.maxBackoff&&(me+=_e.backoffIncrement)}function _(){++he}function S(){var t=de;de=[],t.length>0&&y(!1,t,!1)}function k(){if(--he,0>he)throw"Calls to startBatch() and endBatch() are not paired";0!==he||l()||pe||S()}function C(){if(!l()){var t={channel:"/meta/connect",connectionType:ne.getType()};we||(t.advice={timeout:0}),u("connecting"),oe._debug("Connect sent",t),y(!1,[t],!0,"connect"),u("connected")}}function E(){u("connecting"),b(function(){C()})}function j(t){t&&(ye=oe._mixin(!1,{},_e.advice,t),oe._debug("New advice",ye))}function N(t){if(v(),t&&ne&&ne.abort(),fe=null,u("disconnected"),he=0,x(),ne=null,de.length>0){var e=de;de=[],ke.call(oe,void 0,e,{reason:"Disconnected"})}}function O(t,e,n){var i=oe.onTransportFailure;if(r(i)){oe._debug("Invoking transport failure callback",t,e,n);try{i.call(oe,t,e,n)}catch(o){oe._info("Exception during execution of transport failure callback",o)}}}function R(t,e){r(t)&&(e=t,t=void 0),fe=null,c(),l()?(ce.reset(),j(_e.advice)):j(oe._mixin(!1,ye,{reconnect:"retry"})),he=0,pe=!0,re=t,ie=e;var n="1.0",i=oe.getURL(),o=ce.findTransportTypes(n,ae,i),s={version:n,minimumVersion:n,channel:"/meta/handshake",supportedConnectionTypes:o,_callback:e,advice:{timeout:ye.timeout,interval:ye.interval}},a=oe._mixin(!1,{},re,s);if(!ne&&(ne=ce.negotiateTransport(o,n,ae,i),!ne)){var f="Could not find initial transport among: "+ce.getTransportTypes();throw oe._warn(f),f}oe._debug("Initial transport is",ne.getType()),u("handshaking"),oe._debug("Handshake sent",a),y(!1,[a],!1,"handshake")}function L(){u("handshaking"),pe=!0,b(function(){R(re,ie)})}function A(t){var e=Te[t.id];r(e)&&(delete Te[t.id],e.call(oe,t))}function U(t){A(t),m("/meta/handshake",t),m("/meta/unsuccessful",t);var e=!l()&&"none"!==ye.reconnect;e?(w(),L()):N(!1)}function I(t){if(t.successful){fe=t.clientId;var e=oe.getURL(),n=ce.negotiateTransport(t.supportedConnectionTypes,t.version,ae,e);if(null===n){var r="Could not negotiate transport with server; client=["+ce.findTransportTypes(t.version,ae,e)+"], server=["+t.supportedConnectionTypes+"]",i=oe.getTransport();return O(i.getType(),null,{reason:r,connectionType:i.getType(),transport:i}),oe._warn(r),void N(!0)}ne!==n&&(oe._debug("Transport",ne.getType(),"->",n.getType()),ne=n),pe=!1,S(),t.reestablish=xe,xe=!0,A(t),m("/meta/handshake",t);var o=l()?"none":ye.reconnect;switch(o){case"retry":x(),E();break;case"none":N(!1);break;default:throw"Unrecognized advice action "+o}}else U(t)}function q(t){var e="1.0",n=oe.getURL(),r=oe.getTransport(),i=ce.findTransportTypes(e,ae,n),o=ce.negotiateTransport(i,e,ae,n);o?(oe._debug("Transport",r.getType(),"->",o.getType()),O(r.getType(),o.getType(),t.failure),U(t),ne=o):(O(r.getType(),null,t.failure),oe._warn("Could not negotiate transport; client=["+i+"]"),N(!0),U(t))}function F(t){m("/meta/connect",t),m("/meta/unsuccessful",t);var e=l()?"none":ye.reconnect;switch(e){case"retry":E(),w();break;case"handshake":ce.reset(),x(),L();break;case"none":N(!1);break;default:throw"Unrecognized advice action"+e}}function P(t){if(we=t.successful){m("/meta/connect",t);var e=l()?"none":ye.reconnect;switch(e){case"retry":x(),E();break;case"none":N(!1);break;default:throw"Unrecognized advice action "+e}}else F(t)}function D(t){we=!1,F(t)}function M(t){N(!0),A(t),m("/meta/disconnect",t),m("/meta/unsuccessful",t)}function J(t){t.successful?(N(!1),A(t),m("/meta/disconnect",t)):M(t)
}function B(t){M(t)}function $(t){var e=ge[t.subscription];if(e)for(var n=e.length-1;n>=0;--n){var r=e[n];if(r&&!r.listener){delete e[n],oe._debug("Removed failed subscription",r);break}}A(t),m("/meta/subscribe",t),m("/meta/unsuccessful",t)}function Z(t){t.successful?(A(t),m("/meta/subscribe",t)):$(t)}function H(t){$(t)}function W(t){A(t),m("/meta/unsubscribe",t),m("/meta/unsuccessful",t)}function z(t){t.successful?(A(t),m("/meta/unsubscribe",t)):W(t)}function V(t){W(t)}function X(t){A(t),m("/meta/publish",t),m("/meta/unsuccessful",t)}function G(t){void 0===t.successful?void 0!==t.data?m(t.channel,t):oe._warn("Unknown Bayeux Message",t):t.successful?(A(t),m("/meta/publish",t)):X(t)}function Y(t){X(t)}function Q(t){if(t=d(t),void 0!==t&&null!==t){j(t.advice);var e=t.channel;switch(e){case"/meta/handshake":I(t);break;case"/meta/connect":P(t);break;case"/meta/disconnect":J(t);break;case"/meta/subscribe":Z(t);break;case"/meta/unsubscribe":z(t);break;default:G(t)}}}function K(t){var e=ge[t];if(e)for(var n=0;n<e.length;++n)if(e[n])return!0;return!1}function te(t,e){var i={scope:t,method:e};if(r(t))i.scope=void 0,i.method=t;else if(n(e)){if(!t)throw"Invalid scope "+t;if(i.method=t[e],!r(i.method))throw"Invalid callback "+e+" for scope "+t}else if(!r(e))throw"Invalid callback "+e;return i}function ee(t,e,n,r){var i=te(e,n);oe._debug("Adding",r?"listener":"subscription","on",t,"with scope",i.scope,"and callback",i.method);var o={channel:t,scope:i.scope,callback:i.method,listener:r},s=ge[t];return s||(s=[],ge[t]=s),o.id=s.push(o)-1,oe._debug("Added",r?"listener":"subscription",o),o[0]=t,o[1]=o.id,o}var ne,re,ie,oe=this,se=t||"default",ae=!1,ce=new org.cometd.TransportRegistry,ue="disconnected",le=0,fe=null,he=0,de=[],pe=!1,ge={},me=0,ve=null,be=[],ye={},Te={},xe=!1,we=!1,_e={protocol:null,stickyReconnect:!0,connectTimeout:0,maxConnections:2,backoffIncrement:1e3,maxBackoff:6e4,logLevel:"info",reverseIncomingExtensions:!0,maxNetworkDelay:1e4,requestHeaders:{},appendMessageTypeToURL:!0,autoBatch:!1,advice:{timeout:6e4,interval:0,reconnect:"retry"}};this._mixin=function(t,n){for(var r=n||{},i=2;i<arguments.length;++i){var o=arguments[i];if(void 0!==o&&null!==o)for(var s in o){var a=e(o,s),c=e(r,s);if(a!==n&&void 0!==a)if(t&&"object"==typeof a&&null!==a)if(a instanceof Array)r[s]=this._mixin(t,c instanceof Array?c:[],a);else{var u="object"!=typeof c||c instanceof Array?{}:c;r[s]=this._mixin(t,u,a)}else r[s]=a}}return r},this._warn=function(){i("warn",arguments)},this._info=function(){"warn"!==_e.logLevel&&i("info",arguments)},this._debug=function(){"debug"===_e.logLevel&&i("debug",arguments)},this._isCrossDomain=function(t){return t&&t!==window.location.host};var Se,ke;this.send=T,this.receive=Q,Se=function(t){oe._debug("Received",t);for(var e=0;e<t.length;++e){var n=t[e];Q(n)}},ke=function(t,e,n){oe._debug("handleFailure",t,e,n),n.transport=t;for(var r=0;r<e.length;++r){var i=e[r],o={id:i.id,successful:!1,channel:i.channel,failure:n};switch(n.message=i,i.channel){case"/meta/handshake":q(o);break;case"/meta/connect":D(o);break;case"/meta/disconnect":B(o);break;case"/meta/subscribe":o.subscription=i.subscription,H(o);break;case"/meta/unsubscribe":o.subscription=i.subscription,V(o);break;default:Y(o)}}},this.registerTransport=function(t,e,n){var i=ce.add(t,e,n);return i&&(this._debug("Registered transport",t),r(e.registered)&&e.registered(t,this)),i},this.notifyListeners=m,this.getTransportTypes=function(){return ce.getTransportTypes()},this.unregisterTransport=function(t){var e=ce.remove(t);return null!==e&&(this._debug("Unregistered transport",t),r(e.unregistered)&&e.unregistered()),e},this.unregisterTransports=function(){ce.clear()},this.findTransport=function(t){return ce.find(t)},this.configure=function(t){o.call(this,t)},this.init=function(t,e){this.configure(t),this.handshake(e)},this.handshake=function(t,e){u("disconnected"),xe=!1,R(t,e)},this.disconnect=function(t,e,n){if(!l()){"boolean"!=typeof t&&(n=e,e=t,t=!1),r(e)&&(n=e,e=void 0);var i={channel:"/meta/disconnect",_callback:n},o=this._mixin(!1,{},e,i);u("disconnecting"),y(t===!0,[o],!1,"disconnect")}},this.startBatch=function(){_()},this.endBatch=function(){k()},this.batch=function(t,e){var n=te(t,e);this.startBatch();try{n.method.call(n.scope),this.endBatch()}catch(r){throw this._info("Exception during execution of batch",r),this.endBatch(),r}},this.addListener=function(t,e,r){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!n(t))throw"Illegal argument type: channel must be a string";return ee(t,e,r,!0)},this.removeListener=function(t){if(!(t&&t.channel&&"id"in t))throw"Invalid argument: expected subscription, not "+t;s(t)},this.clearListeners=function(){ge={}},this.subscribe=function(t,e,i,o,s){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!n(t))throw"Illegal argument type: channel must be a string";if(l())throw"Illegal state: already disconnected";r(e)&&(s=o,o=i,i=e,e=void 0),r(o)&&(s=o,o=void 0);var a=!K(t),c=ee(t,e,i,!1);if(a){var u={channel:"/meta/subscribe",subscription:t,_callback:s},f=this._mixin(!1,{},o,u);T(f)}return c},this.unsubscribe=function(t,e,n){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(l())throw"Illegal state: already disconnected";r(e)&&(n=e,e=void 0),this.removeListener(t);var i=t.channel;if(!K(i)){var o={channel:"/meta/unsubscribe",subscription:i,_callback:n},s=this._mixin(!1,{},e,o);T(s)}},this.resubscribe=function(t,e){return a(t),t?this.subscribe(t.channel,t.scope,t.callback,e):void 0},this.clearSubscriptions=function(){c()},this.publish=function(t,e,i,o){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!n(t))throw"Illegal argument type: channel must be a string";if(/^\/meta\//.test(t))throw"Illegal argument: cannot publish to meta channels";if(l())throw"Illegal state: already disconnected";r(e)?(o=e,e=i={}):r(i)&&(o=i,i={});var s={channel:t,data:e,_callback:o},a=this._mixin(!1,{},i,s);T(a)},this.getStatus=function(){return ue},this.isDisconnected=l,this.setBackoffIncrement=function(t){_e.backoffIncrement=t},this.getBackoffIncrement=function(){return _e.backoffIncrement},this.getBackoffPeriod=function(){return me},this.setLogLevel=function(t){_e.logLevel=t},this.registerExtension=function(t,e){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!n(t))throw"Illegal argument type: extension name must be a string";for(var i=!1,o=0;o<be.length;++o){var s=be[o];if(s.name===t){i=!0;break}}return i?(this._info("Could not register extension with name",t,"since another extension with the same name already exists"),!1):(be.push({name:t,extension:e}),this._debug("Registered extension",t),r(e.registered)&&e.registered(t,this),!0)},this.unregisterExtension=function(t){if(!n(t))throw"Illegal argument type: extension name must be a string";for(var e=!1,i=0;i<be.length;++i){var o=be[i];if(o.name===t){be.splice(i,1),e=!0,this._debug("Unregistered extension",t);var s=o.extension;r(s.unregistered)&&s.unregistered();break}}return e},this.getExtension=function(t){for(var e=0;e<be.length;++e){var n=be[e];if(n.name===t)return n.extension}return null},this.getName=function(){return se},this.getClientId=function(){return fe},this.getURL=function(){if(ne&&"object"==typeof _e.urls){var t=_e.urls[ne.getType()];if(t)return t}return _e.url},this.getTransport=function(){return ne},this.getConfiguration=function(){return this._mixin(!0,{},_e)},this.getAdvice=function(){return this._mixin(!0,{},ye)},org.cometd.WebSocket=window.WebSocket},org.cometd.Utils={},org.cometd.Utils.isString=function(t){return void 0===t||null===t?!1:"string"==typeof t||t instanceof String},org.cometd.Utils.isArray=function(t){return void 0===t||null===t?!1:t instanceof Array},org.cometd.Utils.inArray=function(t,e){for(var n=0;n<e.length;++n)if(t===e[n])return n;return-1},org.cometd.Utils.setTimeout=function(t,e,n){return window.setTimeout(function(){try{t._debug("Invoking timed function",e),e()}catch(n){t._debug("Exception invoking timed function",e,n)}},n)},org.cometd.Utils.clearTimeout=function(t){window.clearTimeout(t)},org.cometd.JSON={},org.cometd.JSON.toJSON=org.cometd.JSON.fromJSON=function(){throw"Abstract"},org.cometd.Transport=function(){var t,e;this.registered=function(n,r){t=n,e=r},this.unregistered=function(){t=null,e=null},this._debug=function(){e._debug.apply(e,arguments)},this._mixin=function(){return e._mixin.apply(e,arguments)},this.getConfiguration=function(){return e.getConfiguration()},this.getAdvice=function(){return e.getAdvice()},this.setTimeout=function(t,n){return org.cometd.Utils.setTimeout(e,t,n)},this.clearTimeout=function(t){org.cometd.Utils.clearTimeout(t)},this.convertToMessages=function(t){if(org.cometd.Utils.isString(t))try{return org.cometd.JSON.fromJSON(t)}catch(e){throw this._debug("Could not convert to JSON the following string",'"'+t+'"'),e}if(org.cometd.Utils.isArray(t))return t;if(void 0===t||null===t)return[];if(t instanceof Object)return[t];throw"Conversion Error "+t+", typeof "+typeof t},this.accept=function(){throw"Abstract"},this.getType=function(){return t},this.send=function(){throw"Abstract"},this.reset=function(){this._debug("Transport",t,"reset")},this.abort=function(){this._debug("Transport",t,"aborted")},this.toString=function(){return this.getType()}},org.cometd.Transport.derive=function(t){function e(){}return e.prototype=t,new e},org.cometd.RequestTransport=function(){function t(t){for(;f.length>0;){var e=f[0],n=e[0],r=e[1];if(n.url!==t.url||n.sync!==t.sync)break;f.shift(),t.messages=t.messages.concat(n.messages),this._debug("Coalesced",n.messages.length,"messages from request",r.id)}}function e(t,e){if(this.transportSend(t,e),e.expired=!1,!t.sync){var n=this.getConfiguration().maxNetworkDelay,r=n;e.metaConnect===!0&&(r+=this.getAdvice().timeout),this._debug("Transport",this.getType(),"waiting at most",r,"ms for the response, maxNetworkDelay",n);var i=this;e.timeout=this.setTimeout(function(){e.expired=!0;var n="Request "+e.id+" of transport "+i.getType()+" exceeded "+r+" ms max network delay",o={reason:n},s=e.xhr;o.httpCode=i.xhrStatus(s),i.abortXHR(s),i._debug(n),i.complete(e,!1,e.metaConnect),t.onFailure(s,t.messages,o)},r)}}function n(t){var n=++c,r={id:n,metaConnect:!1};l.length<this.getConfiguration().maxConnections-1?(l.push(r),e.call(this,t,r)):(this._debug("Transport",this.getType(),"queueing request",n,"envelope",t),f.push([t,r]))}function r(t){var e=t.id;if(this._debug("Transport",this.getType(),"metaConnect complete, request",e),null!==u&&u.id!==e)throw"Longpoll request mismatch, completing request "+e;u=null}function i(e,r){var i=org.cometd.Utils.inArray(e,l);if(i>=0&&l.splice(i,1),f.length>0){var o=f.shift(),s=o[0],a=o[1];if(this._debug("Transport dequeued request",a.id),r)this.getConfiguration().autoBatch&&t.call(this,s),n.call(this,s),this._debug("Transport completed request",e.id,s);else{var c=this;this.setTimeout(function(){c.complete(a,!1,a.metaConnect);var t={reason:"Previous request failed"},e=a.xhr;t.httpCode=c.xhrStatus(e),s.onFailure(e,s.messages,t)},0)}}}function o(t){if(null!==u)throw"Concurrent metaConnect requests not allowed, request id="+u.id+" not yet completed";var n=++c;this._debug("Transport",this.getType(),"metaConnect send, request",n,"envelope",t);var r={id:n,metaConnect:!0};e.call(this,t,r),u=r}var s=new org.cometd.Transport,a=org.cometd.Transport.derive(s),c=0,u=null,l=[],f=[];return a.complete=function(t,e,n){n?r.call(this,t):i.call(this,t,e)},a.transportSend=function(){throw"Abstract"},a.transportSuccess=function(t,e,n){e.expired||(this.clearTimeout(e.timeout),this.complete(e,!0,e.metaConnect),n&&n.length>0?t.onSuccess(n):t.onFailure(e.xhr,t.messages,{httpCode:204}))},a.transportFailure=function(t,e,n){e.expired||(this.clearTimeout(e.timeout),this.complete(e,!1,e.metaConnect),t.onFailure(e.xhr,t.messages,n))},a.send=function(t,e){e?o.call(this,t):n.call(this,t)},a.abort=function(){s.abort();for(var t=0;t<l.length;++t){var e=l[t];this._debug("Aborting request",e),this.abortXHR(e.xhr)}u&&(this._debug("Aborting metaConnect request",u),this.abortXHR(u.xhr)),this.reset()},a.reset=function(){s.reset(),u=null,l=[],f=[]},a.abortXHR=function(t){if(t)try{t.abort()}catch(e){this._debug(e)}},a.xhrStatus=function(t){if(t)try{return t.status}catch(e){this._debug(e)}return-1},a},org.cometd.TransportRegistry=function(){var t=[],e={};this.getTransportTypes=function(){return t.slice(0)},this.findTransportTypes=function(n,r,i){for(var o=[],s=0;s<t.length;++s){var a=t[s];e[a].accept(n,r,i)===!0&&o.push(a)}return o},this.negotiateTransport=function(n,r,i,o){for(var s=0;s<t.length;++s)for(var a=t[s],c=0;c<n.length;++c)if(a===n[c]){var u=e[a];if(u.accept(r,i,o)===!0)return u}return null},this.add=function(n,r,i){for(var o=!1,s=0;s<t.length;++s)if(t[s]===n){o=!0;break}return o||("number"!=typeof i?t.push(n):t.splice(i,0,n),e[n]=r),!o},this.find=function(n){for(var r=0;r<t.length;++r)if(t[r]===n)return e[n];return null},this.remove=function(n){for(var r=0;r<t.length;++r)if(t[r]===n){t.splice(r,1);var i=e[n];return delete e[n],i}return null},this.clear=function(){t=[],e={}},this.reset=function(){for(var n=0;n<t.length;++n)e[t[n]].reset()}},org.cometd.WebSocketTransport=function(){function t(){if(!f){f=!0;var t=r.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",t);try{var e=r.getConfiguration().protocol,n=e?new org.cometd.WebSocket(t,e):new org.cometd.WebSocket(t)}catch(i){throw s=!1,this._debug("Exception while creating WebSocket object",i),i}c=r.getConfiguration().stickyReconnect!==!1;var o=this,a=null,u=r.getConfiguration().connectTimeout;u>0&&(a=this.setTimeout(function(){a=null,o._debug("Transport",o.getType(),"timed out while connecting to URL",t,":",u,"ms");var e={code:1e3,reason:"Connect Timeout"};o.webSocketClose(n,e.code,e.reason),o.onClose(n,e)},u));var l=function(){o._debug("WebSocket opened",n),f=!1,a&&(o.clearTimeout(a),a=null),h?(r._warn("Closing Extra WebSocket Connections",n,h),o.webSocketClose(n,1e3,"Extra Connection")):o.onOpen(n)},d=function(t){t=t||{code:1e3},o._debug("WebSocket closing",n,t),f=!1,a&&(o.clearTimeout(a),a=null),null!==h&&n!==h?o._debug("Closed Extra WebSocket Connection",n):o.onClose(n,t)},p=function(t){o._debug("WebSocket message",t,n),n!==h&&r._warn("Extra WebSocket Connections",n,h),o.onMessage(n,t)};n.onopen=l,n.onclose=d,n.onerror=function(){d({code:1002,reason:"Error"})},n.onmessage=p,this._debug("Transport",this.getType(),"configured callbacks on",n)}}function e(t,e,n){var r=org.cometd.JSON.toJSON(e.messages);t.send(r),this._debug("Transport",this.getType(),"sent",e,"metaConnect =",n);var i=this.getConfiguration().maxNetworkDelay,o=i;n&&(o+=this.getAdvice().timeout,d=!0);for(var s=this,a=[],c=0;c<e.messages.length;++c)!function(){var n=e.messages[c];n.id&&(a.push(n.id),l[n.id]=this.setTimeout(function(){s._debug("Transport",s.getType(),"timing out message",n.id,"after",o,"on",t);var e={code:1e3,reason:"Message Timeout"};s.webSocketClose(t,e.code,e.reason),s.onClose(t,e)},o))}();this._debug("Transport",this.getType(),"waiting at most",o,"ms for messages",a,"maxNetworkDelay",i,", timeouts:",l)}function n(n,r,i){try{null===n?t.call(this):e.call(this,n,r,i)}catch(o){this.setTimeout(function(){r.onFailure(n,r.messages,{exception:o})},0)}}var r,i=new org.cometd.Transport,o=org.cometd.Transport.derive(i),s=!0,a=!1,c=!0,u={},l={},f=!1,h=null,d=!1,p=null;return o.reset=function(){i.reset(),s=!0,a=!1,c=!0,u={},l={},f=!1,h=null,d=!1,p=null},o.onOpen=function(t){this._debug("Transport",this.getType(),"opened",t),h=t,a=!0,this._debug("Sending pending messages",u);for(var n in u){var r=u[n],i=r[0],o=r[1];p=i.onSuccess,e.call(this,t,i,o)}},o.onMessage=function(t,e){this._debug("Transport",this.getType(),"received websocket message",e,t);for(var n=!1,r=this.convertToMessages(e.data),i=[],o=0;o<r.length;++o){var s=r[o];if((/^\/meta\//.test(s.channel)||void 0!==s.successful)&&s.id){i.push(s.id);var a=l[s.id];a&&(this.clearTimeout(a),delete l[s.id],this._debug("Transport",this.getType(),"removed timeout for message",s.id,", timeouts",l))}"/meta/connect"===s.channel&&(d=!1),"/meta/disconnect"!==s.channel||d||(n=!0)}for(var c=!1,f=0;f<i.length;++f){var h=i[f];for(var g in u){var m=g.split(","),v=org.cometd.Utils.inArray(h,m);if(v>=0){c=!0,m.splice(v,1);var b=u[g][0],y=u[g][1];delete u[g],m.length>0&&(u[m.join(",")]=[b,y]);break}}}c&&this._debug("Transport",this.getType(),"removed envelope, envelopes",u),p.call(this,r),n&&this.webSocketClose(t,1e3,"Disconnect")},o.onClose=function(t,e){this._debug("Transport",this.getType(),"closed",t,e),s=c&&a;var n=l;l={};for(var r in n)this.clearTimeout(n[r]);var i=u;u={};for(var o in i){var f=i[o][0],p=i[o][1];p&&(d=!1),f.onFailure(t,f.messages,{websocketCode:e.code,reason:e.reason})}h=null},o.registered=function(t,e){i.registered(t,e),r=e},o.accept=function(){return s&&!!org.cometd.WebSocket&&r.websocketEnabled!==!1},o.send=function(t,e){this._debug("Transport",this.getType(),"sending",t,"metaConnect =",e);for(var r=[],i=0;i<t.messages.length;++i){var o=t.messages[i];o.id&&r.push(o.id)}u[r.join(",")]=[t,e],this._debug("Transport",this.getType(),"stored envelope, envelopes",u),n.call(this,h,t,e)},o.webSocketClose=function(t,e,n){try{t.close(e,n)}catch(r){this._debug(r)}},o.abort=function(){if(i.abort(),h){var t={code:1001,reason:"Abort"};this.webSocketClose(h,t.code,t.reason),this.onClose(h,t)}this.reset()},o},org.cometd.LongPollingTransport=function(){var t=new org.cometd.RequestTransport,e=org.cometd.Transport.derive(t),n=!0;return e.accept=function(t,e){return n||!e},e.xhrSend=function(){throw"Abstract"},e.transportSend=function(t,e){this._debug("Transport",this.getType(),"sending request",e.id,"envelope",t);var r=this;try{var i=!0;e.xhr=this.xhrSend({transport:this,url:t.url,sync:t.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(t.messages),onSuccess:function(i){r._debug("Transport",r.getType(),"received response",i);var o=!1;try{var s=r.convertToMessages(i);0===s.length?(n=!1,r.transportFailure(t,e,{httpCode:204})):(o=!0,r.transportSuccess(t,e,s))}catch(a){if(r._debug(a),!o){n=!1;var c={exception:a};c.httpCode=r.xhrStatus(e.xhr),r.transportFailure(t,e,c)}}},onError:function(o,s){n=!1;var a={reason:o,exception:s};a.httpCode=r.xhrStatus(e.xhr),i?r.setTimeout(function(){r.transportFailure(t,e,a)},0):r.transportFailure(t,e,a)}}),i=!1}catch(o){n=!1,this.setTimeout(function(){r.transportFailure(t,e,{exception:o})},0)}},e.reset=function(){t.reset(),n=!0},e},org.cometd.CallbackPollingTransport=function(){function t(t,e,n){var r=this;return function(){r.transportFailure(t,e,"error",n)}}var e=new org.cometd.RequestTransport,n=org.cometd.Transport.derive(e),r=2e3;return n.accept=function(){return!0},n.jsonpSend=function(){throw"Abstract"},n.transportSend=function(e,n){for(var i=this,o=0,s=e.messages.length,a=[];s>0;){var c=org.cometd.JSON.toJSON(e.messages.slice(o,o+s)),u=e.url.length+encodeURI(c).length;if(u>r){if(1===s){var l="Bayeux message too big ("+u+" bytes, max is "+r+") for transport "+this.getType();return void this.setTimeout(t.call(this,e,n,l),0)}--s}else a.push(s),o+=s,s=e.messages.length-o}var f=e;if(a.length>1){var h=0,d=a[0];this._debug("Transport",this.getType(),"split",e.messages.length,"messages into",a.join(" + ")),f=this._mixin(!1,{},e),f.messages=e.messages.slice(h,d),f.onSuccess=e.onSuccess,f.onFailure=e.onFailure;for(var p=1;p<a.length;++p){var g=this._mixin(!1,{},e);h=d,d+=a[p],g.messages=e.messages.slice(h,d),g.onSuccess=e.onSuccess,g.onFailure=e.onFailure,this.send(g,n.metaConnect)}}this._debug("Transport",this.getType(),"sending request",n.id,"envelope",f);try{var m=!0;this.jsonpSend({transport:this,url:f.url,sync:f.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(f.messages),onSuccess:function(t){var e=!1;try{var r=i.convertToMessages(t);0===r.length?i.transportFailure(f,n,{httpCode:204}):(e=!0,i.transportSuccess(f,n,r))}catch(o){i._debug(o),e||i.transportFailure(f,n,{exception:o})}},onError:function(t,e){var r={reason:t,exception:e};m?i.setTimeout(function(){i.transportFailure(f,n,r)},0):i.transportFailure(f,n,r)}}),m=!1}catch(v){this.setTimeout(function(){i.transportFailure(f,n,{exception:v})},0)}},n},function(){function t(t,e){function n(t,e){if(e)for(var n in e)"content-type"!==n.toLowerCase()&&t.setRequestHeader(n,e[n])}function r(){var r=new e.LongPollingTransport,i=e.Transport.derive(r);return i.xhrSend=function(e){return t.ajax({url:e.url,async:e.sync!==!0,type:"POST",contentType:"application/json;charset=UTF-8",data:e.body,global:!1,xhrFields:{withCredentials:!0},beforeSend:function(t){return t.withCredentials=!0,n(t,e.headers),!0},success:e.onSuccess,error:function(t,n,r){e.onError(n,r)}})},i}function i(){var r=new e.CallbackPollingTransport,i=e.Transport.derive(r);return i.jsonpSend=function(e){t.ajax({url:e.url,async:e.sync!==!0,type:"GET",dataType:"jsonp",jsonp:"jsonp",data:{message:e.body},beforeSend:function(t){return n(t,e.headers),!0},success:e.onSuccess,error:function(t,n,r){e.onError(n,r)}})},i}return e.JSON.toJSON=JSON.stringify,e.JSON.fromJSON=JSON.parse,t.CometD=function(t){var n=new e.CometD(t);return e.WebSocket&&n.registerTransport("websocket",new e.WebSocketTransport),n.registerTransport("long-polling",new r),n.registerTransport("callback-polling",new i),n},t.cometd=new t.CometD,t.cometd}"function"==typeof define&&define.amd?define(["jquery","org/cometd"],t):t(jQuery,org.cometd)}();